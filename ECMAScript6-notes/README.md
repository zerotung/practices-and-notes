# let å’Œ const å‘½ä»¤

## let å‘½ä»¤

### åŸºæœ¬ç”¨æ³•

`let` å‘½ä»¤åªåœ¨å…¶æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚

```javascript
{ let a = 10; var b = 1; }
a // ReferenceError: a is not defined.
b // 1
```

`for` å¾ªç¯è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨ `let` å‘½ä»¤ã€‚

```javascript
for (let i = 0; i < 10; i++) {}
console.log(i); // ReferenceError: i is not defined.
```

ä¸‹é¢çš„ä»£ç å¦‚æœä½¿ç”¨ `var` ï¼Œè¾“å‡ºç»“æœæ˜¯10ã€‚ `i` æ˜¯ `var` å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´æœ‰æ•ˆã€‚æ–°çš„ `i` ä¼šè¦†ç›–æ—§å€¼ã€‚

```javascript
var a = [];
for (var i = 0; i < 10; i++) {
  a[i] = function() {
    console.log(i);
  };
}
a[6](); // 10
```

å¦‚æœä½¿ç”¨ `let` ï¼Œå£°æ˜çš„å˜é‡ä»…åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œæœ€åè¾“å‡ºçš„æ˜¯6ã€‚

```javascript
var a = [];
for (let i = 0; i < 10; i++) {
  a[i] = function() {
    console.log(i);
  };
}
a[6](); // 6
```

åœ¨ `for` å¾ªç¯ä¸­ï¼Œå¾ªç¯è¯­å¥éƒ¨åˆ†æ˜¯ä¸€ä¸ªçˆ¶ä½œç”¨åŸŸï¼Œè€Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­ä½œç”¨åŸŸã€‚

```javascript
for (let i = 0; i < 3; i++) {
  let i = 'abc';
  console.log(i);
}
 // abc abc abc
```

### ä¸å­˜åœ¨å˜é‡æå‡

å˜é‡ä¸€å®šè¦åœ¨å£°æ˜åä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚

```javascript
console.log(foo); // undefined
var foo = 2;
console.log(bar); // ReferenceError
let bar = 2;
```

### æš‚æ—¶æ€§æ­»åŒº

åªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨ `let` å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±â€œç»‘å®šâ€ï¼ˆbindingï¼‰è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“ã€‚è¿™åœ¨è¯­æ³•ä¸Šï¼Œæˆä¸ºâ€œæš‚æ—¶æ€§æ­»åŒºâ€ï¼ˆTemporal Dead Zoneï¼Œç®€ç§° TDZï¼‰ã€‚

```javascript
var tmp = 123;
if(true) {
  tmp = 'abc'; // ReferenceError
  let tmp;
}
```

â€œæš‚æ—¶æ€§æ­»åŒºâ€æ„å‘³ç€ `typeof` ä¸å†æ˜¯ä¸€ä¸ªç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„æ“ä½œã€‚

```javascript
typeof x; // ReferenceError
let x;
typeof undeclared_variable; // "undefined"
```

ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ `x` ä½¿ç”¨ `let` å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥åœ¨å£°æ˜ä¹‹å‰ï¼Œéƒ½å±äº `x` çš„â€œæ­»åŒºâ€ï¼Œåªè¦ç”¨åˆ°è¯¥å˜é‡å°±ä¼šæŠ¥é”™ã€‚å¦‚æœä¸€ä¸ªå˜é‡æ ¹æœ¬æ²¡æœ‰è¢«ä»€ä¹ˆï¼Œä½¿ç”¨ `typeof` åè€Œä¸ä¼šæŠ¥é”™ã€‚

æœ‰äº›â€œæ­»åŒºâ€æ¯”è¾ƒéšè”½ï¼Œä¸å¤ªå®¹æ˜“å‘ç°ã€‚

```javascript
function bar(x = y, y = 2) {
  return [x, y];
}
bar(); // æŠ¥é”™
var x = x; // ä¸æŠ¥é”™
let x = x; // ReferenceError: x is not defined
```

è°ƒç”¨ `bar` å‡½æ•°æŠ¥é”™ï¼Œå› ä¸ºå‚æ•° `x` é»˜è®¤å€¼ç­‰äºå¦ä¸€ä¸ªå‚æ•° `y` ï¼Œè€Œæ­¤æ—¶ `y` è¿˜æ²¡æœ‰å£°æ˜ï¼Œå±äºâ€œæ­»åŒºâ€ã€‚

### ä¸å…è®¸é‡å¤å£°æ˜

`let` ä¸å…è®¸åœ¨åŒä¸€ä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ã€‚å› æ­¤ï¼Œä¸èƒ½å†å‡½æ•°å†…éƒ¨é‡å¤å£°æ˜å‚æ•°ã€‚

```javascript
function func(arg) {
  let arg; // æŠ¥é”™
}
function func(arg) {
  {
    let arg; //ä¸æŠ¥é”™
  }
}
```

## å—çº§ä½œç”¨åŸŸ

### ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸ

1. å†…å±‚å˜é‡å¯èƒ½ä¼šè¦†ç›–å¤–å±‚å˜é‡

   ```javascript
   var tmp = new Date();
   function f() {
     console.log(tmp);
     if (false) {
       var tmp = "hello world";
     }
   }
   f(); // undefined
   ```

2. ç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡

   ```javascript
   var s = "hello";
   for (var i = 0; i < s.length; i++) {
     console.log(s[i]);
   }
   console.log(i); // 5
   ```

### ES6çš„å—çº§ä½œç”¨åŸŸ

`let` å®é™…ä¸Šä¸º JavaScript æ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚å¤–å±‚ä»£ç å—ä¸å—å†…å±‚ä»£ç å—çš„å½±å“ã€‚

```javascript
function f1() {
  let n = 5;
  if (true) { let n = 10; }
  console.log(n); // 5
}
```

ES6 å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥—ï¼Œå¤–å±‚ä½œç”¨åŸŸæ— æ³•è¯»å–å†…å±‚ä½œç”¨åŸŸçš„å˜é‡ã€‚å†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ã€‚å—çº§ä½œç”¨åŸŸçš„å‡ºç°ï¼Œä½¿å¾—å¹¿æ³›åº”ç”¨çš„ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰ä¸å†å¿…è¦äº†ã€‚

```javascript
{{{{
  let insane1 = 'Hello World';
  {
    let insane1 = 'Hello World';
    let insane2 = 'Hello World';
  }
  console.log(insane2) // ReferenceError
}}}}

(function() { // IIFE å†™æ³•
  var tmp = ...;
  ...
}());
{ // å—çº§ä½œç”¨åŸŸå†™æ³•
  let tmp = ...;
  ...
}
```

### å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜

ES5 è§„å®šï¼Œå‡½æ•°åªèƒ½åœ¨é¡¶å±‚ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œä¸èƒ½å†å—çº§ä½œç”¨åŸŸå£°æ˜ã€‚å¦‚ï¼š

```javascript
if (true) { function f() {}}
try { function f() {} } catch(e) {}
```

åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ã€‚

ES6 å¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¸­å£°æ˜å‡½æ•°ã€‚ES6 è§„å®šï¼Œå—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äº `let` ï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚

è€ƒè™‘åˆ°ç¯å¢ƒå¯¼è‡´çš„è¡Œä¸ºå·®å¼‚å¤ªå¤§ï¼Œåº”è¯¥é¿å…åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚

```javascript
{ // å‡½æ•°å£°æ˜è¯­å¥
  let a = 'secret';
  function f() { return a; }
}
{ // å‡½æ•°è¡¨è¾¾å¼
  let a = 'secret';
  let f = function () { return a; };
}
```

ES6 çš„å—çº§ä½œç”¨åŸŸå…è®¸å£°æ˜å‡½æ•°çš„è§„åˆ™ï¼Œåªåœ¨ä½¿ç”¨å¤§æ‹¬å·çš„æƒ…å†µä¸‹æˆç«‹ã€‚å¦‚æœæœªä½¿ç”¨å¤§æ‹¬å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚

### do è¡¨è¾¾å¼

æœ¬è´¨ä¸Šï¼Œå—çº§ä½œç”¨åŸŸæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå°†å¤šä¸ªæ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚ç°åœ¨æœ‰ä¸€ä¸ªææ¡ˆï¼Œä½¿å¾—å—çº§ä½œç”¨åŸŸå¯ä»¥å˜ä¸ºè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¿”å›å€¼ï¼ŒåŠæ³•å°±æ˜¯åœ¨å—çº§ä½œç”¨åŸŸå‰åŠ ä¸Š `do` ï¼Œä½¿å®ƒå˜ä¸º `do` è¡¨è¾¾å¼ã€‚

```javascript
let x = do { let t = f(); t * t + 1;}
```

## const å‘½ä»¤

`const` å£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚

```javascript
const PI = 3.1415;
PI // 3.1415
PI = 3 // TypeError: Assignment to constant variable.
```

`const` å£°æ˜å¿…é¡»åˆå§‹åŒ–ï¼Œè‹¥åªå£°æ˜ä¸èµ‹å€¼å°±ä¼šæŠ¥é”™ã€‚

`const` çš„ä½œç”¨åŸŸä¸ `let` å‘½ä»¤ç›¸åŒï¼Œåªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œå¸¸é‡å£°æ˜ä¹Ÿä¸æå‡ï¼ŒåŒæ ·å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼Œåªèƒ½åœ¨å£°æ˜çš„ä½ç½®åé¢ä½¿ç”¨ã€‚ä¸å¯é‡å¤å£°æ˜ã€‚

å¯¹äºå¤åˆç±»å‹çš„å˜é‡ï¼Œå˜é‡åä¸æŒ‡å‘æ•°æ®ï¼Œè€Œæ˜¯æŒ‡å‘æ•°æ®æ‰€åœ¨çš„åœ°å€ã€‚`const` å‘½ä»¤åªæ˜¯ä¿è¯å˜é‡åæŒ‡å‘çš„åœ°å€ä¸å˜ï¼Œä¸ä¿è¯æ•°æ®ä¸å˜ã€‚

```javascript
const foo = {};
foo.prop = 123;
foo.prop // 123
foo = {}; // TypeError: "foo" is read-only

const a = [];
a.push('hello'); // å¯æ‰§è¡Œ
a.length = 0; // å¯æ‰§è¡Œ
a = ['Dave']; // æŠ¥é”™
```

å¦‚æœçœŸçš„æƒ³å°†å¯¹è±¡å†»ç»“ï¼Œåº”è¯¥ä½¿ç”¨ `Object.freeze` æ–¹æ³•ã€‚

```javascript
const foo = Object.freeze({});
// å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼›
// ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™
foo.prop = 123;
```

é™¤äº†å°†å¯¹è±¡æœ¬èº«å†»ç»“ï¼Œå¯¹è±¡çš„å±æ€§ä¹Ÿåº”è¯¥å†»ç»“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¯¹è±¡å½»åº•å†»ç»“çš„å‡½æ•°ã€‚

```javascript
var constantize = (obj) => {
  Object.freeze(obj);
  Object.keys(obj).forEach((key, value) => {
    if (typeof obj[key] === 'object') {
      constantize(obj[key]);
    }
  });
};
```

## é¡¶å±‚å¯¹è±¡çš„å±æ€§

é¡¶å±‚å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯ `window` å¯¹è±¡ï¼Œåœ¨NodeæŒ‡çš„æ˜¯ `global` å¯¹è±¡ã€‚ES5 ä¹‹ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æ˜¯ç­‰ä»·çš„ã€‚è¿™æ ·çš„è®¾è®¡ä¼šå¸¦æ¥å‡ ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼š

1. æ²¡æ³•å†ç¼–è¯‘æ—¶å°±æŠ¥å‡ºå˜é‡æœªå£°æ˜çš„é”™è¯¯ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“
2. ç¨‹åºå‘˜å¾ˆå®¹æ˜“ä¸çŸ¥ä¸è§‰åœ°åˆ›å»ºäº†å…¨å±€å˜é‡
3. é¡¶å±‚å¯¹è±¡çš„å±æ€§æ˜¯åˆ°å¤„å¯ä»¥è¯»å†™çš„ï¼Œä¸åˆ©äºæ¨¡å—åŒ–ç¼–ç¨‹
4. `window` å¯¹è±¡æœ‰å®ä½“å«ä¹‰ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨çš„çª—å£å¯¹è±¡ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ä¸€ä¸ªæœ‰å®ä½“å«ä¹‰çš„å¯¹è±¡ï¼Œä¹Ÿä¸é€‚åˆ

ES6 ä¸­ï¼Œ`var` å‘½ä»¤å’Œ `function` å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚`let` å‘½ä»¤ã€`const` å‘½ä»¤ã€`class` å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡å±æ€§ã€‚

```javascript
var a = 1;
// å¦‚æœåœ¨Nodeçš„REPLç¯å¢ƒï¼Œå¯ä»¥å†™æˆglobal.a
// å¦‚æœé‡‡ç”¨é€šç”¨æ–¹æ³•ï¼Œå†™æˆthis.a
window.a // 1
let b = 1;
window.b // undefined
```

## global å¯¹è±¡

ES5 çš„é¡¶å±‚å¯¹è±¡ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒåœ¨å„ç§å®ç°é‡Œé¢æ˜¯ä¸ç»Ÿä¸€çš„ã€‚

- æµè§ˆå™¨é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ `window` ï¼Œä½† Node å’Œ Web Worker æ²¡æœ‰ `window` 
- æµè§ˆå™¨å’Œ Web Worker é‡Œé¢ï¼Œ`self` ä¹ŸæŒ‡å‘é¡¶å±‚å¯¹è±¡ï¼Œä½†æ˜¯ Node æ²¡æœ‰ `self`
- Node é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ `global` ï¼Œä½†å…¶ä»–ç¯å¢ƒéƒ½ä¸æ”¯æŒ

åŒä¸€æ®µä»£ç ä¸ºäº†èƒ½å¤Ÿåœ¨å„ä¸ªç¯å¢ƒï¼Œéƒ½èƒ½æ¸ é“é¡¶å±‚å¯¹è±¡ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨ `this` å˜é‡ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ã€‚ä¸‹é¢æä¾›ä¸¤ç§å‹‰å¼ºå¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚

```javascript
// æ–¹æ³•ä¸€
(typeof window !== 'undefined'
  ? window
  : (typeof process === 'object' &&
     typeof require === 'function' &&
     typeof global === 'object')
    ? global
    : this);

// æ–¹æ³•äºŒ
var getGlobal = function () {
  if (typeof self !== 'undefined') { return self; }
  if (typeof window !== 'undefined') { return window; }
  if (typeof global !== 'undefined') { return global; }
  throw new Error('unable to locate global object');
};
```

# å˜é‡çš„è§£æ„èµ‹å€¼

## æ•°ç»„çš„è§£æ„èµ‹å€¼

### åŸºæœ¬ç”¨æ³•

ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå˜é‡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚

```javascript
let [a, b, c] = [1, 2, 3];
```

ES6 å…è®¸å†™æˆä¸Šé¢è¿™æ ·ï¼Œä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šèµ‹äºˆå¯¹åº”çš„å€¼ã€‚

```javascript
let [foo, [[bar], baz]] = [1, [[2], 3]]; // foo=1;bar=2;baz=3
let [ , , third] = ['foo', 'bar', 'baz']; // third='baz'
let [x, , y] = [1, 2, 3]; // x=1;y=3
let [head, ...tail] = [1, 2, 3, 4]; //head=1;tail=4
let [x, y, ...z] = ['a']; // x='a';y=undefined;z=[]
```

å¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äº `undefined` ã€‚

å¦ä¸€ç§æƒ…å†µæ˜¯ä¸å®Œå…¨è§£æ„ï¼Œå³ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚è¿™ç§æƒ…å†µä¾ç„¶å¯ä»¥è§£æ„æˆåŠŸã€‚

```javascript
let [x, y] = [1, 2, 3]; // x=1;y=2
let [a, [b], d] = [1, [2, 3], 4]; // a=1;b=2;d=4
```

å¦‚æœç­‰å·çš„å³è¾¹ä¸æ˜¯æ•°ç»„ï¼ˆæˆ–è€…ä¸¥æ ¼çš„è¯´ï¼Œä¸æ˜¯å¯éå†çš„ç»“æ„ï¼‰ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™

```javascript
let [foo] = 1; let [foo] = false; let [foo] = NaN; let [foo] = undefined; let [foo] = null; let [foo] = {};
```

å¯¹äº Set ç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚

```javascript
let [x, y, z] = new Set(['a', 'b', 'c']);
x // "a"
```

å®é™…ä¸Šï¼Œåªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰ Iterator æ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚ä¸‹é¢ä»£ç ä¸­ï¼Œ `fibs` æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼ŒåŸç”Ÿå…·æœ‰ Iterator æ¥å£ã€‚è§£æ„èµ‹å€¼ä¼šä¾æ¬¡ä»è¿™ä¸ªæ¥å£è·å–å€¼ã€‚

```javascript
function* fibs() {
  let a = 0;
  let b = 1;
  while(true) {
    yield a;
    [a, b] = [b, a + b];
  }
}
let [first, second, third, fourth, fifth, sixth] = fibs();
sixth // 5
```

### é»˜è®¤å€¼

è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼ã€‚ES6 å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ `===` åˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸ä¸¥æ ¼ç­‰äº `undefined` ï¼Œé»˜è®¤å€¼æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚

```javascript
let [foo = true] = []; foo //true
let [x, y = 'b'] = ['a']; // x='a';y='b'
let [x, y = 'b'] = ['a', undefined]; // x='a';y='b'
let [x = 1] = [null]; x // null
```

å¦‚æœé»˜è®¤å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ï¼Œå³åªæœ‰åœ¨ç”¨åˆ°çš„æ—¶å€™ï¼Œæ‰ä¼šæ±‚å€¼ã€‚

```javascript
function f() {
  console.log('aaa');
}
let [x = f()] = [1];
```

ä¸Šé¢çš„ä»£ç ç”±äº `x` èƒ½å–åˆ°å€¼ï¼Œæ‰€ä»¥å‡½æ•° `f` æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚é»˜è®¤å€¼å¯ä»¥å¼•ç”¨è§£æ„èµ‹å€¼çš„å…¶ä»–å˜é‡ï¼Œä½†è¯¥å˜é‡å¿…é¡»å·²ç»å£°æ˜ã€‚

```javascript
let [x = 1, y = x] = []; // x=1; y=1
let [x = 1, y = x] = [2]; // x=2; y=2
let [x = 1, y = x] = [1, 2]; // x=1; y=2
let [x = y, y = 1] = []; // ReferenceError
```

## å¯¹è±¡çš„è§£æ„èµ‹å€¼

å¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒã€‚æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åºçš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚

```javascript
let { foo, bar } = { foo: "aaa", bar: "bbb" };
foo // "aaa"
bar // "bbb"
let { baz } = { foo: "aaa", bar: "bbb" };
baz // undefined
```

ä¸Šé¢ä»£ç çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œç­‰å·å·¦è¾¹çš„ä¸¤ä¸ªå˜é‡çš„æ¬¡åºï¼Œä¸ç­‰å·å³è¾¹çš„ä¸¤ä¸ªåŒåå±æ€§çš„æ¬¡åºä¸ä¸€è‡´ï¼Œä½†æ˜¯å¯¹å–å€¼å®Œå…¨æ²¡æœ‰å½±å“ã€‚ç¬¬äºŒä¸ªä¾‹å­çš„å˜é‡æ²¡æœ‰å¯¹åº”çš„åŒåå±æ€§ï¼Œå¯¼è‡´å–ä¸åˆ°å€¼ï¼Œæœ€åç­‰äº `undefined` ã€‚

å¦‚æœå˜é‡åä¸å±æ€§åä¸ä¸€è‡´ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚å¯¹è±¡çš„è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…ã€‚

```javascript
var { foo: baz } = { foo: 'aaa', bar: 'bbb' };
baz // "aaa"
let obj = { first: 'hello', last: 'world' };
let { first: f, last: l } = obj;
f // 'hello'
l // 'world'
```

é‡‡ç”¨è¿™ç§å†™æ³•æ—¶ï¼Œå˜é‡çš„å£°æ˜å’Œèµ‹å€¼æ˜¯ä¸€ä½“çš„ã€‚å¯¹äº `let` å’Œ `const` æ¥è¯´ï¼Œå˜é‡ä¸èƒ½é‡æ–°å£°æ˜ã€‚

```javascript
let foo; ({foo} = {foo: 1});
let baz; ({bar: baz} = {bar: 1});
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`let` å‘½ä»¤åçš„åœ†æ‹¬å·æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™è§£æå™¨ä¼šå°†èµ·é¦–çš„å¤§æ‹¬å·ï¼Œç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œè€Œä¸æ˜¯èµ‹å€¼è¯­å¥ã€‚

å’Œæ•°ç»„ä¸€æ ·ï¼Œè§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡ã€‚

```javascript
let obj = {
  p: [
    'Hello',
    { y: 'World'}
  ]
};
let { p: [x, { y }] } = obj;
x // "Hello"
y // "World"

let node = {
  loc: {
    start: {
      line: 1,
      column: 5
    }
  }
};
var { loc: { start: { line }} } = node;
line // 1
loc // error: loc is undefined
start // error: loc is undefined
```

ä¸‹é¢æ˜¯åµŒå¥—èµ‹å€¼çš„ä¾‹å­ã€‚

```javascript
let obj = {};
let arr = [];
({ foo: obj.prop, bar: arr[0] } = { foo: 123, bar: true });
obj // {prop:123}
arr // [true]
```

å¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äº `undefined` ã€‚

```javascript
var { x = 3 } = {}; // x=3
var { x, y = 5 } = { x: 1 }; // x=1; y=5
var { x: y = 3 } = {}; // y=3
var { x: y = 3 } = { x: 5 } // y=5
var { message: msg = 'Something went wrong' } = {}; // msg="Something went wrong"
var { x = 3 } = { x: undefined }; // x=3
var { x = 3 } = { x: null }; // x=null
```

å¦‚æœè§£æ„å¤±è´¥ï¼Œå˜é‡çš„å€¼ç­‰äº `undefined` ï¼Œå¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚

```javascript
let { foo } = { bar: 'baz' };
foo // undefined

let { foo: {bar}} = { bar: 'baz' }; // æŠ¥é”™
```

å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ç°æœ‰çš„å¯¹è±¡çš„æ–¹æ³•ï¼Œèµ‹å€¼åˆ°æŸä¸ªå˜é‡ã€‚

```javascript
let { log, sin, cos } = Math;
```

ç”±äºæ•°ç»„æœ¬è´¨æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡å±æ€§çš„è§£æ„ã€‚

```javascript
let arr = [1, 2, 3];
let {0: first, [arr.length -1] : last} = arr;
first // 1
last // 3
```

## å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼

å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚

```javascript
const [a, b, c, d, e] = 'hello';
// a='h'; b='e'; c='l'; d='l'; e='o'
```

ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª `length` å±æ€§ï¼Œå› æ­¤è¿˜å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼ã€‚

```javascript
let { length: len } = 'hello';
len // 5
```

## æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼

å¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚

```javascript
let {toString: s} = 123;
s === Number.prototype.toString // true
let {toString: s} = true;
s === Boolean.prototype.toString // true
```

è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äº `undefined` å’Œ `null` æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹ä»–ä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚

## å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼

```javascript
function add([x, y]) {
  return x + y;
}
add([1, 2]) // 3
```

å‡½æ•° `add` çš„å‚æ•°è¡¨é¢ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½†åœ¨ä¼ å…¥å‚æ•°çš„é‚£ä¸€åˆ»ï¼Œå‚æ•°å°±è¢«è§£ææˆäº† `x` å’Œ `y` ã€‚

```javascript
[[1, 2], [3, 4]].map(([a, b]) => a + b); // [3, 7]
```

å‡½æ•°å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ç”±äºåä¸€ä¸ªå‡½æ•° `move` çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯å˜é‡ `x` å’Œ `y` æŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚

```javascript
function move({x = 0, y = 0} = {}) {
  return [x, y];
}
move({x: 3, y: 8}); // [3, 8]
move({x: 3}); // [3, 0]
move({}); // [0, 0]
move(); // [0, 0]

function move({x, y} = {x: 0, y: 0}) {
  return [x, y];
}
move({x: 3, y: 8}); // [3, 8]
move({x: 3}); // [3, undefined]
move({}); // [undefined, undefined]
move(); // [0, 0]
```

`undefined` å°±ä¼šè§¦å‘å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼

```javascript
[1, undefined, 3].map((x = 'yes') => x); // [1, 'yes', 3]
```

## åœ†æ‹¬å·é—®é¢˜

ES6çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚å»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚

ä»¥ä¸‹ä¸‰ç§è§£æ„èµ‹å€¼ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·

1. å˜é‡å£°æ˜è¯­å¥ä¸­ï¼Œä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·
2. å‡½æ•°å‚æ•°ä¸­ï¼Œæ¨¡å¼ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·
3. èµ‹å€¼è¯­å¥ä¸­ï¼Œä¸èƒ½å°†æ•´ä¸ªæ¨¡å¼ï¼Œæˆ–åµŒå¥—æ¨¡å¼ä¸­çš„ä¸€å±‚ï¼Œæ”¾åœ¨åœ†æ‹¬å·ä¸­

å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µåªæœ‰ä¸€ç§ï¼šèµ‹å€¼è¯­å¥çš„éæ¨¡å¼éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚

```javascript
[(b)] = [3]; ({ p: (d) } = {}); [(parseInt.prop)] = [3];
```

## ç”¨é€”

1. äº¤æ¢å˜é‡çš„å€¼

   ```javascript
   let x = 1, y = 2; [x, y] = [y, x];
   ```

2. ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼

   ```javascript
   function foo() { return [1, 2, 3]; } // è¿”å›ä¸€ä¸ªæ•°ç»„
   let [a, b, c] = foo();
   function bar() { return { a: 1, b: 2}; } // è¿”å›ä¸€ä¸ªå¯¹è±¡
   let { a, b } = bar();
   ```

3. å‡½æ•°å‚æ•°çš„å®šä¹‰

   ```javascript
   function f([x, y, z]) { ... } // å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼
   f([1, 2, 3]);
   function f({x, y, z}) { ... } // å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼
   f({z: 3, y: 2, x: 1});
   ```

4. æå– JSON æ•°æ®

   ```javascript
   let jsonData = { id: 42, status: "OK", data: [867, 5309] };
   let { id, status, data: number } = jsonData;
   console.log(id, status, number); // 42, "OK", [867, 5309]
   ```

5. å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼

   ```javascript
   jQuery.ajax = function (url, {
     async = true, beforeSend = function() {}, cache = true,
     complete = function() {}, crossDomain = false, global = true,
     // ... more config
   }) {
     // ... do stuff
   };
   ```

6. éå† Map ç»“æ„

   ä»»ä½•éƒ¨ç½²äº† Iterator æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨ `forâ€¦of` å¾ªç¯éå†ã€‚Map ç»“æ„åŸç”Ÿæ”¯æŒ Iterator æ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿äº†ã€‚

   ```javascript
   var map = new Map();
   map.set('first', 'hello');
   map.set('second', 'world');
   for (let [key, value] of map) {
     console.log(key + " is" + value);
   }
   // first is hello  second is world
   for (let [key] of map) { ... } // è·å–é”®å
   for (let [, value] of map) { ... } // è·å–é”®å€¼
   ```

7. è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³•

   åŠ è½½æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šè¾“å…¥å“ªäº›æ–¹æ³•ã€‚è§£æ„èµ‹å€¼ä½¿å¾—è¾“å…¥è¯­å¥éå¸¸æ¸…æ™°ã€‚

   ```javascript
   const { SourceMapConsumer, SourceNode } = require("source-map");
   ```

# å­—ç¬¦ä¸²çš„æ‰©å±•

## å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•

JavaScript å…è®¸é‡‡ç”¨ `\uxxxx` å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œä½†è¿™ç§è¡¨ç¤ºæ–¹æ³•ä»…é™äº `\u0000-\uFFFF` ä¹‹é—´çš„å­—ç¬¦ã€‚

ES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚

```javascript
"\u{20BB7}" // "ğ ®·"
"\u{41}\u{42}\u{43}" // "ABC"
let hello = 123; hell\u{6F} // 123
'\u{1F680}' === '\uD83D\uDE80' // true
```

æœ‰äº†è¿™ç§è¡¨ç¤ºæ³•åï¼ŒJavaScript å…±æœ‰ 6 ç§æ–¹æ³•è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚

```javascript
'z' === '\z' === '\172' === '\x7A' === '\u007A' === '\u{7A}'
```

## codePointAt()

```javascript
var s = "ğ ®·";
s.length // 2
s.charAt(0) // ''
s.charAt(1) // ''
s.charCodeAt(0) //55362
s.charCodeAt(1) //57271
```

å¯¹äº 4 ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScript ä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º 2ï¼Œè€Œä¸”`charAt` æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼Œ `charCodeAt` æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚

ES6 æä¾›äº† `codePointAt` æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚

```javascript
var s = 'ğ ®·a';
s.codePointAt(0) // 134071 0x20BB7
s.codePointAt(1) // 57271
s.codePointAt(2) // 97
```

`codePointAt` æ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸Šï¼Œæ­£ç¡®åœ°è¯†åˆ«äº†â€œğ ®·â€ï¼Œåœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆâ€œğ ®·â€çš„åä¸¤ä¸ªå­—èŠ‚ï¼‰å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸Šï¼Œ`codePointAt` å’Œ `charCodeAt` æ–¹æ³•ç›¸åŒã€‚

`codePointAt` æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼ï¼Œå¦‚æœæƒ³è¦åå…­è¿›åˆ¶çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ `toString` æ–¹æ³•è½¬æ¢ä¸€ä¸‹ã€‚

```javascript
var s = 'ğ ®·a';
s.codePointAt(0).toString(16); // "20bb7"
```

ä½¿ç”¨ `for â€¦ of` å¾ªç¯æ­£ç¡®è¯†åˆ« 32 ä½çš„ UTF-16 å­—ç¬¦ã€‚

```javascript
var s = 'ğ ®·a';
for (let ch of s) {
  console.log(ch.codePointAt(0).toString(16));
}
// 20bb7  61
```

`codePointAt` æ–¹æ³•æ—¶æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚

```javascript
function is32Bit(c) {
  return c.codePointAt(0) > 0xFFFF;
}
is32Bit("ğ ®·") // true
is32Bit("a") // false
```

## String.fromCodePoint()

ES6 æä¾›äº† `String.fromCodePoint()` æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ« 32 ä½çš„ UTF-16å­—ç¬¦ï¼Œå¼¥è¡¥äº† `String.fromCharCode` æ–¹æ³•çš„ä¸è¶³ã€‚ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸ `codePointAt` æ–¹æ³•ç›¸åã€‚

```javascript
String.fromCodePoint(0x20BB7) // "ğ ®·"
```

æ³¨æ„ï¼Œ`fromCodePoint` æ–¹æ³•å®šä¹‰åœ¨ `String` å¯¹è±¡ä¸Šï¼Œè€Œ `codePointAt` æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚

## å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£

ES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢« `for â€¦ of` å¾ªç¯éå†ã€‚å¯ä»¥è¯†åˆ«å¤§äº `0xFFFF` çš„ç ç‚¹ã€‚

```javascript
for (let codePoint of 'foo') {
  console.log(codePoint);
} // "f", "o", "o"
```

## at()

ES5 å¯¹å­—ç¬¦ä¸²å¯¹è±¡æä¾› `charAt` æ–¹æ³•ï¼Œè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦ã€‚ä½†è¯¥æ–¹æ³•æ— æ³•è¯†åˆ«ç ç‚¹å¤§äº `0xFFFF` çš„å­—ç¬¦ã€‚ç›®å‰æœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºå­—ç¬¦ä¸²å®ä¾‹çš„ `at` æ–¹æ³•ï¼Œç”¨äºè¯†åˆ«è¿”å›ç ç‚¹å¤§äº `0xFFFF` çš„æ­£ç¡®çš„å­—ç¬¦ã€‚

```javascript
'abc'.at(0) // "a"
'ğ ®·'.at(0) // "ğ ®·"
```

## normalize()

ç”¨äºè§£å†³è¯­è°ƒç¬¦å·å’Œé‡éŸ³ç¬¦å·åœ¨è§†è§‰å’Œè¯­ä¹‰ä¸Šç­‰ä»·ï¼Œä½†æ˜¯ JavaScript ä¸è¯†åˆ«çš„é—®é¢˜ã€‚

```javascript
'\u01D1' === '\u004F\u030c' // false Ç‘(\u01D1) Ç‘(\u004F\u030c)
'\u01D1'.normalize() === '\u004F\u030c'.normalize() // true
```

## includes(), startsWith(), endsWith()

- **includes()** è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²
- **startsWith()** è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å¤´éƒ¨
- **endsWith()** è¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å°¾éƒ¨

```javascript
var s = 'Hello world!';
s.startsWith('Hello') // true
s.endsWith('!') // true
s.includes('o') // true
s.startsWith('world', 6) // true
s.endsWith('Hello', 5) // true
s.includes('Hello', 6) //false
```

## repeat()

`repeat()` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤ n æ¬¡ã€‚å‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¼šè¢«å–æ•´ï¼Œå¦‚æœæ˜¯è´Ÿæ•°æˆ–è€… `Infinity` ï¼Œä¼šæŠ¥é”™ï¼ˆ-1 åˆ° 0 ä¹‹é—´çš„å°æ•°ä¼šç­‰åŒäº 0ï¼‰ã€‚`NaN` ç­‰åŒäº 0ã€‚è‹¥å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆæ•°å­—ã€‚

```javascript
'hello'.repeat(2) // "hellohello"
```

## padStart(), padEnd()

ES7 æ¨å‡ºäº†å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦çš„åŠŸèƒ½ã€‚å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚`padStart` ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼Œ`padEnd` ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚

```javascript
'x'.padStart(5, 'ab') // 'ababx'
'x'.padEnd(4, 'ab') // 'xaba'
'xxx'.padStart(2, 'ab') // 'xxx'
'abc'.padStart(10, '0123456789') // '0123456abc'
'x'.padStart(4) // '   x'
'x'.padEnd(4) // 'x   '
```

`padStart` çš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°ï¼Œä»¥åŠæç¤ºå­—ç¬¦ä¸²æ ¼å¼ã€‚

```javascript
'12'.padStart(10, '0') // "0000000012"
'09-12'.padStart(10, 'YYYY-MM-DD') // "YYYY-09-12"
```

## æ¨¡æ¿å­—ç¬¦ä¸²

æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“åšæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚

```javascript
`In JavaScript '\n' is a line-feed.`;
console.log(`string text line1
string text line 2`);
var name = "Bob", time = "today";
`Hello ${name}, how are you ${time}?`
```

ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²çš„ç©ºæ ¼å’Œæ¢è¡Œï¼Œéƒ½ä¼šè¢«ä¿ç•™ã€‚æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ï¼Œéœ€å†™åœ¨ `${}` ä¸­ã€‚å¤§æ‹¬å·å†…å¯ä»¥æ”¾å…¥ä»»æ„çš„ JavaScript è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ï¼Œè°ƒç”¨å‡½æ•°ã€‚å¦‚æœå¤§æ‹¬å·ä¸­çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†æŒ‰ç…§ä¸€èˆ¬çš„è§„åˆ™è½¬ä¸ºå­—ç¬¦ä¸²ã€‚å¦‚æœå˜é‡æ²¡æœ‰å£°æ˜ï¼Œå°†æŠ¥é”™ã€‚

## æ ‡ç­¾æ¨¡å—

æ¨¡æ¿å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸Šé¢è¿™äº›ã€‚å®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚

```javascript
alert`123` /* ç­‰åŒäº */ alert('123')
```

ä½†æ˜¯ï¼Œå¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå…ˆå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°

```javascript
var a = 5, b= 10;
tag`Hello ${ a + b} world ${ a * b }`;
// ç­‰åŒäº
tag(['Hello ', ' world ', ''], 15, 50);
```

å‡½æ•° `tag` ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚

```javascript
function tag(stringArr, value1, value2) { ... }
// ç­‰åŒäº
function tag(stringArr, ...values) {}
```

â€œæ ‡ç­¾æ¨¡æ¿â€çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°±æ˜¯è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚

```javascript
var message = SaferHTML`<p>${sender} has sent you a message.</p>`;
function SaferHTML(templateData) {
  var s = templateData[0];
  for (var i = 1; i < arguments.length; i++) {
    var arg = String(arguments[i]);
    // Escape special characters in the substitution.
    s += arg.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
    // Don't escape special characters in the template.
    s += templateData[i];
  }
  return s;
}
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`sender` å˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡ `SaferHTML` å‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚

```javascript
var sender = '<script>alert("abc")</script>'; // æ¶æ„ä»£ç 
var message = SaferHTML`<p>${sender} has sent you a message.</p>`;
message
// <p>&lt;script&gt;alert("abc")&lt;/script&gt; has sent you a message.</p>
```

æ ‡ç­¾æ¨¡æ¿çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œå°±æ˜¯å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚

```javascript
i18n`Welcome to ${siteName}, you are visitor number ${visitorNumber}!`
// "æ¬¢è¿è®¿é—®xxxï¼Œæ‚¨æ˜¯ç¬¬xxxxä½è®¿é—®è€…ï¼"
```

æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ª `raw` å±æ€§ï¼Œä¿å­˜çš„æ˜¯è½¬ä¹‰åçš„åŸå­—ç¬¦ä¸²ã€‚

```javascript
console.log`123` // ["123", raw: Array[1]]

tag`First line\nSecond line`
function tag(strings) {
  console.log(strings.raw[0]);
  // "First line\\nSecond line"
}
```

## String.raw()

ES6 è¿˜ä¸ºåŸç”Ÿçš„ String å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª `raw` æ–¹æ³•ã€‚

`String.raw` æ–¹æ³•ï¼Œå¾€å¾€ç”¨æ¥å……å½“æ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºæ›¿æ¢å˜é‡åçš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚å¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆ `String.raw` ä¸ä¼šåšä»»ä½•å¤„ç†ã€‚

```javascript
String.raw`Hi\n${2+3}!` // "Hi\\n5!"
String.raw`Hi\\n` // "Hi\\n"
String.raw({ raw: 'test' }, 0, 1, 2); // 't0e1s2t'
```

## æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶

ç”±äºæ¨¡æ¿å­—ç¬¦ä¸²é»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå› æ­¤æ— æ³•åµŒå…¥å…¶ä»–è¯­è¨€ã€‚

ç°åœ¨æœ‰ä¸€ä¸ªææ¡ˆï¼Œæ”¾æ¾å¯¹ *æ ‡ç­¾æ¨¡æ¿*  é‡Œé¢çš„å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ã€‚å¦‚æœé‡åˆ°ä¸åˆæ³•çš„å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå°±è¿”å› `undefined` ï¼Œè€Œä¸æ˜¯æŠ¥é”™ï¼Œå¹¶ä¸”ä» `raw` å±æ€§ä¸Šé¢å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚

```javascript
function tag(strs) {
  strs[0] === undefined
  strs.raw[0] === "\\unicode and \\u{55}";
}
tag`\unicode and \u{55}`
```

æ³¨æ„ï¼Œè¿™ç§å­—ç¬¦ä¸²è½¬ä¹‰çš„æ”¾æ¾ï¼Œåªåœ¨æ ‡ç­¾æ¨¡æ¿è§£æå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆï¼Œå…¶ä»–åœºåˆä¾ç„¶ä¼šæŠ¥é”™ã€‚

# æ­£åˆ™çš„æ‰©å±•

## RegExp æ„é€ å‡½æ•°

åœ¨ ES5 ä¸­ï¼ŒRegExp æ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚

- ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰

  ```javascript
  var regex = new RegExp('xyz', 'i'); /* ç­‰ä»·äº */ var regex = /xyz/i;
  ```

- å‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ—¶è¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´

  ```javascript
  var regex = new RegExp(/xyz/i); /* ç­‰ä»·äº */ var regex = /xyz/i;
  ```

ES5 ä¸å…è®¸æ­¤æ—¶ä½¿ç”¨ç¬¬äºŒå‚æ•°ï¼Œæ·»åŠ ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ES6 æ”¹å˜äº†è¿™ç§è¡Œä¸ºã€‚ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ä¿®é¥°ç¬¦ä¼šè¦†ç›–åŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚

```javascript
var regex = new RegExp(/xyz/, 'i'); // ES5
// Uncaught TypeError: Cannot supply flags when constructing one RegExp from another
new RegExp(/abc/ig, 'i').flags // "i"
```

## å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•

å­—ç¬¦ä¸²å¯¹è±¡å…±æœ‰ 4 ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š`match()`ã€`replace()`ã€`search()` å’Œ `split()`ã€‚

ES6 å°†è¿™ 4 ä¸ªæ–¹æ³•ï¼Œåœ¨è¯­è¨€å†…éƒ¨å…¨éƒ¨è°ƒç”¨ RegExp çš„å®ä¾‹æ–¹æ³•ï¼Œä»è€Œåšåˆ°æ‰€æœ‰ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•ï¼Œå…¨éƒ½å®šä¹‰åœ¨ RegExp å¯¹è±¡ä¸Šã€‚

- `String.prototype.match` è°ƒç”¨ `RegExp.prototype[Symbol.match]`
- `String.prototype.replace` è°ƒç”¨ `RegExp.prototype[Symbol.replace]`
- `String.prototype.search` è°ƒç”¨ `RegExp.prototype[Symbol.search]`
- `String.prototype.split` è°ƒç”¨ `RegExp.prototype[Symbol.split]`

## uä¿®é¥°ç¬¦

ES6 å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ  `u` ä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicodeæ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº `\uFFFF` çš„ Unicode å­—ç¬¦ã€‚

```javascript
/^\uD83D/u.test('\uD83D\uDC2A') // false
/^\uD83D/.test('\uD83D\uDC2A') // true
```

### ç‚¹å­—ç¬¦

ç‚¹ `.` å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Š `u` ä¿®é¥°ç¬¦ã€‚

```javascript
var s = 'ğ ®·';
/^.$/.test(s) // false
/^.$/u.test(s) // true
```

### Unicode å­—ç¬¦è¡¨ç¤ºæ³•

ES6 æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤º Unicode å­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Š `u` ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«ã€‚

```javascript
/\u{61}/.test('a') // false
/\u{61}/u.test('a') // true
/\u{20BB7}/u.test('ğ ®·') // true
```

### é‡è¯

ä½¿ç”¨ `u` ä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚

```javascript
/a{2}/.test('aa') // true
/a{2}/u.test('aa') // true
/ğ ®·{2}/.test('ğ ®·ğ ®·') // false
/ğ ®·{2}/u.test('ğ ®·ğ ®·') // true
```

å¦å¤–ï¼Œåªæœ‰åœ¨ä½¿ç”¨ `u` ä¿®é¥°ç¬¦çš„æƒ…å†µä¸‹ï¼ŒUnicode è¡¨è¾¾å¼å½“ä¸­çš„å¤§æ‹¬å·æ‰ä¼šè¢«æ­£ç¡®è§£è¯»ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚

### é¢„å®šä¹‰æ¨¡å¼

`u` ä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚

```javascript
/^\S/.test('ğ ®·') // false
/^\S$/u.test('ğ ®·') // true
```

ä¸Šé¢ä»£ç çš„ `\S` æ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚åªæœ‰åŠ äº† `u` ä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚åˆ©ç”¨è¿™ç‚¹å¯ä»¥å†™å‡ºæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚

```javascript
function codePointLength(text) {
  var result = text.match(/[\s\S]/gu);
  return result ? result.length : 0'
}
var s = 'ğ ®·ğ ®·';
s.length // 4
codePointLength(s) // 2
```

### i ä¿®é¥°ç¬¦

æœ‰äº› Unicode å­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆæ¥è¿‘ï¼Œæ¯”å¦‚ `\u0048` å’Œ `\u212A` éƒ½æ˜¯å¤§å†™çš„ `K` ã€‚

```javascript
/[a-z]/i.test('\u212A') // false
/[a-z]/iu.test('\u212A') // true
```

## y ä¿®é¥°ç¬¦

ES6 è¿˜ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº† `y` ä¿®é¥°ç¬¦ï¼Œå«åšâ€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚

`y` ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸ `g` ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä½å¼€å§‹ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œ`g` ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ä»¥ï¼Œè€Œ `y` ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„å«ä¹‰ã€‚

```javascript
var s = 'aaa_aa_a';
var r1 = /a+/g, r2 = /a+/y, r3 = /a+_/y;
r1.exec(s) // ["aaa"]
r2.exec(s) // ["aaa"]
r3.exec(s) // ["aaa_"]
r1.exec(s) // ["aa"]
r2.exec(s) // null
r3.exec(s) // ["aa_"]
```

ä½¿ç”¨ `lastIndex` å±æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°è¯´æ˜ `y` ä¿®é¥°ç¬¦ã€‚`lastIndex` æŒ‡å®šæ¯æ¬¡æœç´¢çš„å¼€å§‹ä½ç½®ï¼Œ`g` ä¿®é¥°ç¬¦ä»è¿™ä¸ªä½ç½®å¼€å§‹å¾€åæœç´¢ï¼ŒçŸ¥é“å‘ç°åŒ¹é…ä¸ºæ­¢ã€‚`y` ä¿®é¥°ç¬¦è¦æ±‚å¿…é¡»åœ¨ `lastIndex` æŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚è¿›ä¸€æ­¥è¯´ï¼Œ`y` ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿— `^` ã€‚

```javascript
const REGEX = /a/g;
REGEX.lastIndex = 2; // æŒ‡å®šä»2å·ä½(y)å¼€å§‹åŒ¹é…
const match = REGEX.exec('xaya'); // åŒ¹é…æˆåŠŸ
match.index // åœ¨3å·ä½ç½®åŒ¹é…æˆåŠŸ 3
REGEX.lastIndex // ä¸‹æ¬¡åŒ¹é…ä»4å·ä½å¼€å§‹ 4
REGEX.exec('xaxa') // 4å·ä½å¼€å§‹åŒ¹é…å¤±è´¥ null
```

```javascript
const REGEX = /a/gy;
'aaxa'.replace(REGEX, '-') // '--xa'
'a1a2a3'.match(/a\d/y) // ["a1"]
'a1a2a3'.match(/a\d/gy) // ["a1", "a2", "a3"]
```

`y` ä¿®é¥°ç¬¦çš„ä¸€ä¸ªåº”ç”¨ï¼Œæ˜¯ä»å­—ç¬¦ä¸²æå–tokenï¼ˆè¯å…ƒï¼‰ï¼Œ`y` ä¿®é¥°ç¬¦ç¡®ä¿äº†åŒ¹é…ä¹‹é—´ä¸ä¼šæœ‰æ¼æ‰çš„å­—ç¬¦ã€‚`g` ä¼šèƒ¡çƒˆéæ³•å­—ç¬¦ï¼Œè€Œ `y` ä¸ä¼šã€‚æ›´æ˜“å‘ç°é”™è¯¯ã€‚

```javascript
const TOKEN_Y = /\s*(\+|[0-9]+)\s*/y;
const TOKEN_G  = /\s*(\+|[0-9]+)\s*/g;
tokenize(TOKEN_Y, '3 + 4'); // [ '3', '+', '4' ]
tokenize(TOKEN_G, '3 + 4'); // [ '3', '+', '4' ]
function tokenize(TOKEN_REGEX, str) {
  let result = [];
  let match;
  while (match = TOKEN_REGEX.exec(str)) {
    result.push(match[1]);
  }
  return result;
}
tokenize(TOKEN_Y, '3x + 4') // ['3']
tokenize(TOKEN_G, '3x + 4') // ['3', '+', '4']
```

## sticky å±æ€§

ä¸ `y` ä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6 çš„æ­£åˆ™å¯¹è±¡å¤šäº† `sticky` å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº† `y` ä¿®é¥°ç¬¦ã€‚

```javascript
var r = /hello\d/y; r.sticky // true
```

## flags å±æ€§

ES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº† `flags` å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦

```javascript
/abc/ig.source // "abc"
/abc/ig.flags // "gi"
```

## RegExp.escape()

å­—ç¬¦ä¸²å¿…é¡»è½¬ä¹‰ï¼Œæ‰èƒ½ä½œä¸ºæ­£åˆ™æ¨¡å¼ã€‚

```javascript
function escapeExp(str) {
  return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, '\\$&');
}
let str = '/path/to/resource.html?search=query';
escapeRegExp(str) // "\/path\/to\/resource\.html\?search=query"
```

å­—ç¬¦ä¸²è½¬ä¹‰ä»¥åï¼Œå¯ä»¥ä½¿ç”¨ RegExp æ„é€ å‡½æ•°ç”Ÿæˆæ­£åˆ™æ¨¡å¼ã€‚

## s ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼

æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹ `.` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä»£è¡¨ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆé™¤è¡Œç»ˆæ­¢ç¬¦ï¼‰ã€‚ä»¥ä¸‹å››ä¸ªå­—ç¬¦å±äºâ€œè¡Œç»ˆæ­¢ç¬¦â€

- U+000A æ¢è¡Œç¬¦ `\n` 
- U+000D å›è½¦ç¬¦ `\r` 
- U+2028 è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰
- U+2029 æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰

```javascript
/foo.bar/.test('foo\nbar') // false
/foo[^]bar/.test('foo\nbar') // true
```

ç°åœ¨æœ‰ä¸€ä¸ªææ¡ˆï¼Œå¼•å…¥ `\s` ä¿®é¥°ç¬¦ï¼Œä½¿å¾— `.` å¯ä»¥åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚æ­£åˆ™è¡¨è¾¾å¼è¿˜å¼•å…¥ä¸€ä¸ª `dotAll` å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦å¤„åœ¨ `dotAll` æ¨¡å¼ã€‚

`/s` ä¿®é¥°ç¬¦å’Œå¤šè¡Œä¿®é¥°ç¬¦ `/m` ä¸å†²çªï¼Œä¸¤è€…ä¸€èµ·ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œ`.` åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œè€Œ `^` å’Œ `$` åŒ¹é…æ¯ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾ã€‚

## åè¡Œæ–­è¨€

JavaScript è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæ”¯æŒå…ˆè¡Œæ–­è¨€ï¼ˆlookaheadï¼‰å’Œå…ˆè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookaheadï¼‰ï¼Œä¸æ”¯æŒåè¡Œæ–­è¨€ï¼ˆlookbehindï¼‰å’Œåè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookaheadï¼‰ã€‚

- â€œå…ˆè¡Œæ–­è¨€â€æŒ‡çš„æ˜¯ï¼Œ`x` åªæœ‰åœ¨ `y` å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/x(?=y)/` 
- â€œå…ˆè¡Œå¦å®šæ–­è¨€â€å€¼çš„æ˜¯ï¼Œ`x` åªæœ‰ä¸åœ¨ `y` å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/x(?!y)/` 

## Unicode å±æ€§ç±»

ç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œå¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³• `\p{â€¦}` å’Œ `\P{â€¦}` ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆ Unicode æŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚

```javascript
const regexGreekSymbol = /\p{Script=Greek}/u;
regexGreekSymbol.test('Ï€') // u
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`\p{Script=Greek}` æŒ‡å®šåŒ¹é…ä¸€ä¸ªå¸Œè…Šæ–‡å­—å¹•ï¼Œæ‰€ä»¥åŒ¹é…æˆåŠŸã€‚

`\P{â€¦}` æ˜¯ `\p{â€¦}` çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚è¿™ä¸¤ç§ç±»åªå¯¹ Unicode æœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ  `u` ä¿®é¥°ç¬¦ã€‚ç”±äº Unicode çš„å„ç§å±æ€§éå¸¸å¤šï¼Œæ‰€ä»¥è¿™ç§æ–°çš„ç±»çš„è¡¨è¾¾èƒ½åŠ›éå¸¸å¼ºã€‚

```javascript
const regex = /^\p{Decimal_Number}+$/u;
regex.test('ğŸğŸğŸ‘ğŸœğŸğŸğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸºğŸ»ğŸ¼') // true
```

`\p{Number}` ç”šè‡³èƒ½åŒ¹é…ç½—é©¬æ•°å­—ã€‚

```javascript
// åŒ¹é…æ‰€æœ‰æ•°å­—
const regex = /^\p{Number}+$/u;
regex.test('Â²Â³Â¹Â¼Â½Â¾') // true
regex.test('ã‰›ã‰œã‰') // true
regex.test('â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«') // true
```

# æ•°å€¼çš„æ‰©å±•

## äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•

ES6 æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å€¼çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€ `0b(0B)` å’Œ `0o(0O)` è¡¨ç¤ºã€‚å¯ä»¥ä½¿ç”¨ `Number` æ–¹æ³•å°† `0b` å’Œ `0o` å­—ç¬¦ä¸²è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚

```javascript
0b111110111 === 503 // true
0o767 === 503 // true
Number('0b111') // 7
Number('0o10') // 8
```

## Number.isFinite(), Number.isNaN()

ES6 åœ¨ Number å¯¹è±¡ä¸Šï¼Œæ–°æä¾›äº† `Number.isFinite()` å’Œ `Number.isNaN()` ä¸¤ä¸ªæ–¹æ³•ã€‚

`Number.isFinite()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ã€‚éæœ‰é™çš„å€¼åŒ…æ‹¬ `NaN` `(-)Infinity` `'foo'` `'15'` `true` 

`Number.isNaN()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸º `NaN` ã€‚

```javascript
Number.isNaN(NaN) // true
Number.isNaN(15) // false
Number.isNaN('15') // false
Number.isNaN(true) // false
Number.isNaN(9/NaN) // true
Number.isNaN('true'/0) // true
Number.isNaN('true'/'true') // true
```

æ–°æ–¹æ³•åªå¯¹æ•°å€¼æœ‰æ•ˆï¼Œéæ•°å­—ä¸€å¾‹è¿”å› `false` ã€‚

## Number.parseInt(), Number.parseFloat()

ES6 å°†å…¨å±€æ–¹æ³• `parseInt()` å’Œ `parseFloat()` ï¼Œç§»æ¤åˆ° Number å¯¹è±¡ä¸Šï¼Œè¡Œä¸ºä¿æŒä¸å˜ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚

## Number.isInteger()

ç”¨äºåˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ JavaScript å†…éƒ¨ï¼Œæ•´æ•°å’Œæµ®ç‚¹æ•°æ˜¯åŒæ ·çš„å‚¨å­˜æ–¹æ³•ï¼Œæ‰€ä»¥ 3 å’Œ 3.0 è¢«è§†ä¸ºåŒä¸€ä¸ªå€¼ã€‚

```javascript
Number.isInteger(25.0) // true
```

## Number.EPSILON

ES6 åœ¨ Number å¯¹è±¡ä¸Šé¢ï¼Œæ–°å¢äº†ä¸€ä¸ªæå°çš„å¸¸é‡ `Number.EPSILON` ã€‚ç”¨äºä¸ºæµ®ç‚¹æ•°è®¡ç®—è®¾ç½®ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œå¦‚æœè¯¯å·®å°äº `Number.EPSILON` ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå¾—åˆ°æ­£ç¡®ç»“æœã€‚

```javascript
function withinErrorMargin (left, right) {
  return Math.abs(left - right) < Number.EPSILON;
}
withinErrorMargin(0.1 + 0.2, 0.3) // true
withinErrorMargin(0.2 + 0.2, 0.3) // false
```

## å®‰å…¨æ•´æ•°å’Œ Number.isSafeInteger()

JavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨ `-2^53~2^53ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰` ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ã€‚

ES6 å¼•å…¥äº† `Number.MAX_SAFE_INTEGER` å’Œ `Number.MIN_SAFE_INTEGER` ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚`Number.inSafeInteger()` åˆ™æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦è½åœ¨è¿™ä¸ªèŒƒå›´å†…ã€‚

å®é™…ä½¿ç”¨æ—¶ï¼Œä¸è¦åªéªŒè¯è¿ç®—ç»“æœï¼Œè€Œè¦åŒæ—¶éªŒè¯å‚ä¸è¿ç®—çš„æ¯ä¸€ä¸ªå€¼ã€‚

## Math å¯¹è±¡çš„æ‰©å±•

### Math.trunc()

ç”¨äºå»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°éƒ¨åˆ†ã€‚ç”±äºè´Ÿæ•°å°†å¯¼è‡´å‘ä¸Šå‘ä¸‹å–æ•´çš„ä¸åŒã€‚

å¯¹äºéæ•°å€¼ï¼Œ`Math.trunc` å†…éƒ¨ä½¿ç”¨ Number æ–¹æ³•å°†å…¶å…ˆè½¬ä¸ºæ•°å€¼ï¼Œå¯¹äºç©ºå€¼æˆ–æ— æ³•æˆªå–æ•´æ•°çš„å€¼ï¼Œè¿”å› NaNã€‚

```javascript
Math.trunc = Math.trunc || function(x) {
  return x < 0 ? Math.ceil(x) : Math.floor(x);
};
```

### Math.sign()

ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯æ­£æ•°ã€è´Ÿæ•°è¿˜æ˜¯é›¶ã€‚å®ƒè¿”å›äº”ç§å€¼ï¼š

- æ­£æ•°ï¼Œè¿”å› +1
- è´Ÿæ•°ï¼Œè¿”å› -1
- 0ï¼Œè¿”å› 0
- -0ï¼Œè¿”å› -0
- å…¶ä»–å€¼ï¼Œè¿”å› NaN

### Math.cbrt()

ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ï¼Œä¼šå…ˆä½¿ç”¨ Number æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºæ•°å€¼

### Math.clz32

JavaScript çš„æ•´æ•°ä½¿ç”¨ 32 ä½äºŒè¿›åˆ¶å½¢å¼è¡¨ç¤ºï¼Œ`Math.clz32` æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„32ä½æ— ç¬¦å·æ•´æ•°å½¢å¼æœ‰å¤šå°‘ä¸ªå‰å¯¼0ã€‚clz32 å‡½æ•°åæ¥è‡ªâ€œcount leading zero bits in 32-bit binary representations of a numberâ€ã€‚

### Math.imul()

è¿”å›ä¸¤ä¸ªæ•°ä»¥ 32 ä½å¸¦ç¬¦å·æ•´æ•°å½¢å¼ç›¸ä¹˜çš„ç»“æœï¼Œè¿”å›ä¸€ä¸ª 32 ä½çš„å¸¦ç¬¦å·æ•´æ•°ã€‚`Math.imul` æ–¹æ³•å¯ä»¥è¿”å›å¾ˆå¤§çš„æ•°ç›¸ä¹˜æ—¶ï¼Œæ­£ç¡®çš„ä½ä½æ•°å€¼ã€‚

### Math.fround()

è¿”å›ä¸€ä¸ªæ•°çš„å•ç²¾åº¦æµ®ç‚¹æ•°å½¢å¼ã€‚å¯¹æ•´æ•°æ¥è¯´ï¼Œè¿”å›ç»“æœç›¸åŒã€‚å¯¹äºæ— æ³•ç”¨ 64 ä¸ªäºŒè¿›åˆ¶ä½ç²¾ç¡®è¡¨ç¤ºçš„å°æ•°ï¼Œ`Math.fround` æ–¹æ³•ä¼šè¿”å›æœ€æ¥è¿‘è¿™ä¸ªå°æ•°çš„å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚

### Math.hypot()

è¿”å›æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚

### å¯¹æ•°çš„æ–¹æ³•

#### Math.expm1()

`Math.expm1(x)` è¿”å› e^xÂ - 1ï¼Œå³ `Math.exp(x) - 1`ã€‚

#### Math.log1p()

`Math.log1p(x)` æ–¹æ³•è¿”å› `1 + x` çš„è‡ªç„¶å¯¹æ•°ï¼Œå³ `Math.log(1 + x)`ã€‚å¦‚æœ `x` å°äº -1ï¼Œè¿”å› `NaN`ã€‚

#### Math.log10()

`Math.log10(x)` è¿”å›ä»¥ 10 ä¸ºåº•çš„ `x` çš„å¯¹æ•°ã€‚å¦‚æœ `x` å°äº 0ï¼Œåˆ™è¿”å› NaNã€‚

#### Math.log2()

`Math.log10(x)` è¿”å›ä»¥ 2 ä¸ºåº•çš„ `x` çš„å¯¹æ•°ã€‚å¦‚æœ `x` å°äº 0ï¼Œåˆ™è¿”å› NaNã€‚

### ä¸‰è§’å‡½æ•°çš„æ–¹æ³•

- `Math.sinh(x)` è¿”å› `x` çš„åŒæ›²æ­£å¼¦
- `Math.cosh(x)` è¿”å› `x` çš„åŒæ›²ä½™å¼¦
- `Math.tanh(x)` è¿”å› `x` çš„åŒæ›²æ­£åˆ‡
- `Math.asinh(x)` è¿”å› `x` çš„ååŒæ›²æ­£å¼¦
- `Math.acosh(x)` è¿”å› `x` çš„ååŒæ›²ä½™å¼¦
- `Math.atanh(x)` è¿”å› `x` çš„ååŒæ›²æ­£åˆ‡

## æŒ‡æ•°è¿ç®—ç¬¦

ES2016 æ–°å¢äº†ä¸€ä¸ªæŒ‡æ•°è¿ç®—ç¬¦ `**` ã€‚å¯ä»¥ä¸ç­‰å·ç»“åˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„èµ‹å€¼è¿ç®—ç¬¦ `**=` ã€‚

```javascript
let a = 2; a **= 3 // a = a * a * a
```

ä¸ `Math.pow` çš„å®ç°ä¸åŒï¼Œå¯¹äºç‰¹åˆ«å¤§çš„è¿ç®—ç»“æœï¼Œä¸¤è€…ä¼šæœ‰ç»†å¾®çš„å·®å¼‚ã€‚

# æ•°ç»„çš„æ‰©å±•

## Array.from()

ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»ä¼¼æ•°ç»„çš„å¯¹è±¡å’Œå¯éå†çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ ES6 æ–°å¢çš„æ•°æ®ç»“æ„ Set å’Œ Mapï¼‰

```javascript
let arrayLike = { '0': 'a', '1': 'b', '2': 'c', length: 3};
let arr = Array.from(arrayLike); // ['a', 'b', 'c']
```

å®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ˜¯ DOM æ“ä½œè¿”å›çš„ NodeList é›†åˆï¼Œä»¥åŠå‡½æ•°å†…éƒ¨çš„ `arguments` å¯¹è±¡ã€‚`Array.from` éƒ½å¯ä»¥å°†ä»–ä»¬è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚

`querySelectorAll` æ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œåªæœ‰è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œæ‰èƒ½ä½¿ç”¨ `forEach` æ–¹æ³•ã€‚åªè¦æ˜¯éƒ¨ç½²äº† `Iterator` æ¥å£çš„æ•°æ®ç»“æ„ï¼Œ`Array.from` éƒ½èƒ½å°†å…¶è½¬ä¸ºæ•°ç»„ã€‚

æ‰©å±•è¿ç®—ç¬¦ `â€¦` ä¹Ÿå¯ä»¥å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚æ‰©å±•è¿ç®—ç¬¦èƒŒåè°ƒç”¨çš„æ˜¯éå†å™¨æ¥å£ï¼ˆ`Symbol.iteratro` ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æœªéƒ¨ç½²è¿™ä¸ªæ¥å£ï¼Œå°±æ— æ³•è½¬æ¢ã€‚

```javascript
function foo() { var args = [...arguments]; } // argumentså¯¹è±¡
[...document.querySelectorAll('div')] // NodeListå¯¹è±¡
```

ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå¿…é¡»æœ‰ `length` å±æ€§ã€‚å› æ­¤ï¼Œä»»ä½•æœ‰ `length` å±æ€§çš„å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡ `Array.from` æ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢ã€‚

```javascript
Array.from({ length: 3 }); // [ undefined, undefined, undefined ]
```

`Array.from` è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„ `map` æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œç»“æœæ”¾å›æ•°ç»„ã€‚

```javascript
Array.from([1, 2, 3], (x) => x * x) // [1, 4, 9]
function typeOf() { return Array.from(arguments, value => typeof value) }
typeOf(null, [], NaN) // ['object', 'object', 'number']
Array.from({ length: 2 }, () => 'jack') // ['jack', 'jack']
```

## Array.of()

ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚ä¸»è¦ç”¨äºå¼¥è¡¥æ„é€ å‡½æ•° `Array()` çš„ä¸è¶³ã€‚

```javascript
Array.of(3, 11, 8) // [3, 11, 8]
Array.of(3) // [3]
Array(3, 11, 8) // [3, 11, 8]
Array(3) // [, , ,]
```

`Array.of` åŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£ `Array()` æˆ– `new Array()` ã€‚æ€»æ˜¯è¿”å›å‚æ•°å€¼ç»„æˆçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚

## æ•°ç»„å®ä¾‹çš„ copyWithin()

åœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆä¼šè¦†ç›–åŸæœ‰æˆå‘˜ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„ã€‚

```javascript
Array.prototype.copyWithin(target, start = 0, end = this.length)
```

æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œéƒ½åº”è¯¥æ˜¯æ•°å€¼ï¼Œä¸æ˜¯åˆ™è½¬ä¸ºæ•°å€¼ã€‚

- targetï¼ˆå¿…éœ€ï¼‰ä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®
- startï¼ˆå¯é€‰ï¼‰ä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚
- endï¼ˆå¯é€‰ï¼‰åˆ°è¯¥ä½ç½®å‰åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚

```javascript
[1, 2, 3, 4, 5].copyWithin(0, 3) // [4, 5, 3, 4, 5]
```

## æ•°ç»„å®ä¾‹çš„ find() å’Œ findIndex()

### find()

æ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸º `true` çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆçš„æˆå‘˜ï¼Œåˆ™è¿”å› `undefined` ã€‚

```javascript
[1, 4, -5, 10].find((n) => n < 0) // -5
```

`find` æ–¹æ³•çš„å›è°ƒå‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºå½“å‰çš„å€¼ã€å½“å‰çš„ä½ç½®å’ŒåŸæ•°ç»„ã€‚

```javascript
[1, 5, 10, 15].find(function(value, index, arr) {
  return value > 9;
}) // 10
```

### findIndex()

ä¸ `find` ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœéƒ½ä¸ç¬¦åˆæ¡ä»¶åˆ™è¿”å› `-1` ã€‚

```javascript
[1, 5, 10, 15].findIndex(function(value, index, arr) {
  return value > 9;
}) // 2
```

è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šå›è°ƒå‡½æ•°çš„ `this` å¯¹è±¡ã€‚å¦å¤–ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥å‘ç° `NaN` ã€‚

## æ•°ç»„å®ä¾‹çš„ fill()

ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚ç”¨äºç©ºæ•°ç»„çš„åˆå§‹åŒ–éå¸¸æ–¹ä¾¿ã€‚è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä¸ºæ­¢ã€‚

```javascript
['a', 'b', 'c'].fill(7) // [7, 7, 7]
['a', 'b', 'c'].fill(7, 1, 2) // ['a', 7, 'c']
```

## æ•°ç»„å®ä¾‹çš„ entries(), keys() å’Œ values()

ç”¨äºéå†æ•°ç»„ã€‚ä»–ä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨ `for â€¦ of` å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯ `keys()` æ˜¯å¯¹é”®åçš„éå†ã€`values()` æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œ`entries()` æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚

```javascript
for (let index of ['a', 'b'].keys()) { console.log(index); } // 0  1
for (let elem of ['a', 'b'].values()) { console.log(elem); } // 'a'  'b'
for (let [index, elem] of ['a', 'b'].entries()) { console.log(index, elem); }
```

å¦‚æœä¸ä½¿ç”¨ `for â€¦ of` å¾ªç¯ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨éå†å™¨å¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œè¿›è¡Œéå†ã€‚

```javascript
let letter = ['a', 'b', 'c'];
let entries = letter.entries();
console.log(entries.next().value); // [0, 'a']
console.log(entries.next().value); // [1, 'b']
```

## æ•°ç»„å®ä¾‹çš„ includes()

`Array.prototype.includes` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œä¸å­—ç¬¦ä¸²çš„ `includes` æ–¹æ³•ç±»ä¼¼ã€‚è¯¥æ–¹æ³•å±äº ES7ï¼Œä½† Babel è½¬ç å™¨å·²ç»æ”¯æŒã€‚

è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚å¦‚æœä¸ºè´Ÿï¼Œåˆ™å€’æ•°ã€‚å¦‚æœå¤§äºæ•°ç»„é•¿åº¦ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä» 0 å¼€å§‹ã€‚

```javascript
[1, 2, 3].includes(2); // true
[1, 2, NaN].includes(NaN); // true
[1, 2, 3].includes(3, 3); // false
[1, 2, 3].includes(3, -1); // true
```

`indexOf` æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼Œä¸€æ˜¯ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼ŒäºŒæ˜¯å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸å½“è¿ç®—ç¬¦ `===` ï¼Œä¼šå¯¼è‡´ `NaN` çš„è¯¯åˆ¤ã€‚å¦å¤–ï¼ŒMap å’Œ Set æ•°æ®ç»“æ„æœ‰ä¸€ä¸ª `has` æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸ `includes` åŒºåˆ†ã€‚

- Map ç»“æ„çš„ `has` æ–¹æ³•ï¼Œç”¨æ¥æŸ¥æ‰¾é”®å
- Set ç»“æ„çš„ `has` æ–¹æ³•ï¼Œç”¨æ¥æŸ¥æ‰¾å€¼

## æ•°ç»„çš„ç©ºä½

æ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä½æ²¡æœ‰ä»»ä½•å€¼ã€‚æ¯”å¦‚ï¼Œ`Array` æ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ã€‚

```javascript
Array(3) // [, , ,]
0 in [undefined, undefined, undefined] // true
0 in [, , ,] // false
```

æ³¨æ„ï¼Œç©ºä½ä¸æ˜¯ `undefined`ï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº `undefined`ï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„ã€‚ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼çš„ã€‚ES5 å¯¹ç©ºä½çš„å¤„ç†å¾ˆä¸ä¸€è‡´ï¼Œå¤§å¤šæ•°æƒ…å†µä¼šå¿½ç•¥ç©ºä½ã€‚

- `forEach()`ï¼Œ`filter()`ï¼Œ`every()`Â å’Œ `some()` éƒ½ä¼šè·³è¿‡ç©ºä½
- `map()` ä¼šè·³è¿‡ç©ºä½ï¼Œä½†ä¼šä¿ç•™è¿™ä¸ªå€¼
- `join()` å’Œ `toString()` ä¼šå°†ç©ºä½è§†ä¸º `undefined`ï¼Œè€Œ `undefined` å’Œ `null` ä¼šè¢«å¤„ç†æˆç©ºå­—ç¬¦ä¸²

ES6è¿™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º `undefined`ã€‚

- `Array.from`ï¼Œ`entries()`ï¼Œ`keys()`ï¼Œ`values()`ï¼Œ`find()`ï¼Œ`findIndex()` å’Œ `â€¦` ä¼šå°†ç©ºä½è½¬ä¸º `undefined`
- `copyWithin()` ä¼šè¿ç©ºä½ä¸€èµ·æ‹·è´
- `fill()` ä¼šå°†ç©ºä½è§†ä¸ºæ­£å¸¸çš„æ•°ç»„ä½ç½®
- `for .. of` å¾ªç¯ä¹Ÿä¼šéå†ç©ºä½

ç”±äºç©ºä½çš„å¤„ç†è§„åˆ™éå¸¸ä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥å»ºè®®é¿å…å‡ºç°ç©ºä½ã€‚





















